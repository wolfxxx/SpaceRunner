<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Modern Space Invaders</title>
  <!-- Make all relative URLs resolve from src/ so existing paths continue to work -->
  <!-- <base href="src/"> -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cdefs%3E%3ClinearGradient id='space' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23001122;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23000000;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='32' height='32' fill='url(%23space)'/%3E%3C!-- Stars --%3E%3Ccircle cx='6' cy='8' r='1' fill='%23ffffff' opacity='0.8'/%3E%3Ccircle cx='26' cy='6' r='1' fill='%23ffffff' opacity='0.6'/%3E%3Ccircle cx='4' cy='24' r='1' fill='%23ffffff' opacity='0.7'/%3E%3Ccircle cx='28' cy='26' r='1' fill='%23ffffff' opacity='0.5'/%3E%3Ccircle cx='16' cy='4' r='1' fill='%23ffffff' opacity='0.9'/%3E%3C!-- Spaceship --%3E%3Cpath d='M16 6 L12 12 L20 12 Z' fill='%2300ffff'/%3E%3Cpath d='M16 8 L14 10 L18 10 Z' fill='%23ffffff'/%3E%3C!-- Engine glow --%3E%3Cpath d='M14 12 L16 14 L18 12 Z' fill='%23ff6600' opacity='0.8'/%3E%3C!-- Laser beams --%3E%3Cpath d='M16 6 L16 2' stroke='%2300ff00' stroke-width='1' opacity='0.7'/%3E%3Cpath d='M14 6 L12 2' stroke='%2300ff00' stroke-width='1' opacity='0.5'/%3E%3Cpath d='M18 6 L20 2' stroke='%2300ff00' stroke-width='1' opacity='0.5'/%3E%3C/svg%3E" />
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.80.1/dist/phaser.min.js"></script>
  <style>
    html, body { height: 100%; margin: 0; background:#000; }
    body { display:flex; align-items:center; justify-content:center; }
    canvas { image-rendering: pixelated; border:2px solid #333; box-shadow:0 0 20px #0ff; filter: drop-shadow(0 0 8px #0ff) drop-shadow(0 0 3px #0ff); }
    #scanlines { position:fixed; inset:0; pointer-events:none; opacity:.16; mix-blend-mode:screen;
      background-image:repeating-linear-gradient(0deg, rgba(255,255,255,.09) 0px, rgba(255,255,255,.09) 1px, transparent 1px, transparent 3px); }
    #vignette { position:fixed; inset:0; pointer-events:none;
      background:radial-gradient(ellipse at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.35) 100%); }
  </style>
  <!-- Global leaderboard (Firebase) -->
  <script>
    window.FIREBASE_CONFIG = {
      apiKey: "AIzaSyBZW21lAJX2eisfjFtQDhIfBQg6gd4rzSQ",
      authDomain: "spaceinvadersscores-a9177.firebaseapp.com",
      projectId: "spaceinvadersscores-a9177",
      storageBucket: "spaceinvadersscores-a9177.firebasestorage.app",
      messagingSenderId: "551696066897",
      appId: "1:551696066897:web:1901c0860fec3f81f2cb70",
      measurementId: "G-EQ2NZ8WTS1"
    };
    // App Check site key (reCAPTCHA v3)
    window.FIREBASE_APPCHECK_SITE_KEY = "6LeWZr4rAAAAAD4Hq0vsxgn65FgefgwF4IyLTjIW";
    // If running locally, try to load a local-only debug token from src/local-dev.js
    (function(){
      var h = location.hostname;
      if(h === 'localhost' || h === '127.0.0.1'){
        var s = document.createElement('script');
        s.src = 'src/local-dev.js'; // direct path to local-dev.js
        document.head.appendChild(s);
      }
    })();
    
    // Roguelite feature flag (default off). Enable via ?roguelite=1 for local testing.
    (function(){
      var qs = (location.search || '');
      var forcedOn = qs.indexOf('roguelite=1') !== -1;
      var forcedOff = qs.indexOf('roguelite=0') !== -1;
      var stored = null;
      try { stored = localStorage.getItem('si_roguelite'); } catch (e) { stored = null; }
      var enabled = true; // Enable roguelite by default for GitHub Pages
      if(forcedOn) enabled = true;
      else if(forcedOff) enabled = false;
      else if(stored !== null) enabled = stored === '1';
      window.ENABLE_ROGUELITE = enabled;
      window.SET_ROGUELITE_MODE = function(on){
        window.ENABLE_ROGUELITE = !!on;
        try { localStorage.setItem('si_roguelite', window.ENABLE_ROGUELITE ? '1' : '0'); } catch (e) {}
      };
    })();
  </script>
  <script type="module" src="src/leaderboard.js"></script>
  <!-- Note: with <base href="src/"> these scripts resolve to src/music.js and src/game.js -->
</head>
<body>
  <div id="scanlines"></div>
  <div id="vignette"></div>
  <div id="volume-control" style="position:fixed; bottom:20px; left:50%; transform:translateX(-50%); z-index:100;">
    <label for="volume" style="color:#fff; font-family:monospace; margin-right:10px;">Volume:</label>
    <input type="range" id="volume" name="volume" min="0" max="100" value="50">
  </div>
  <script src="src/run-manager.js" data-experimental="roguelite"></script>
  <script src="src/post-run-summary.js" data-experimental="roguelite"></script>
  <script type="module" src="src/roguelite-init.js" data-experimental="roguelite"></script>
  <script src="src/music.js"></script>
  <script src="src/hangar-system.js"></script>
  <script src="src/start-scene.js"></script>
  <script src="src/game.js"></script>
  <!-- Next-Level Enhancement Systems -->
  <script src="src/achievement-system.js"></script>
  <script src="src/enhanced-gameplay.js"></script>
  <script src="src/visual-audio-enhancements.js"></script>
  <script src="src/social-multiplayer-systems.js"></script>
  <script src="src/next-level-integration.js"></script>
</body>
<!--
This root index.html enables GitHub Pages to serve the game from the repository root
without moving files out of src/. The <base href="src/"> ensures asset/script paths
continue to resolve relative to src/.
-->
</html>